<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>AI Animal Shorts Prompt Generator v2.0</title>
<style>
:root{--bg:#0b0b0c;--card:#15161a;--ink:#e9eef3;--muted:#a7b0ba;--accent:#7dd3fc;--accent2:#f9a8d4}
*{box-sizing:border-box;font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial,'Noto Sans TC',sans-serif}
body{margin:0;background:linear-gradient(180deg,#0b0b0c,#101215);color:var(--ink)}
header{padding:16px;position:sticky;top:0;background:rgba(11,11,12,.85);backdrop-filter:saturate(150%) blur(8px);border-bottom:1px solid #1f2937}
h1{margin:0;font-size:20px;letter-spacing:.2px}
main{padding:16px;max-width:980px;margin:0 auto}
.card{background:var(--card);border:1px solid #262b36;border-radius:18px;padding:14px;margin-bottom:14px;box-shadow:0 8px 32px rgba(0,0,0,.25)}
.row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
@media (max-width:760px){.row{grid-template-columns:1fr}}
label{font-size:13px;color:var(--muted);display:block;margin:8px 0 6px}
select,input[type="text"],input[type="number"]{width:100%;padding:10px 12px;background:#0f1114;border:1px solid #2b3340;border-radius:12px;color:var(--ink);outline:none}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;border:1px solid #2b3340;background:#0f1114;color:var(--ink);padding:10px 14px;border-radius:12px;cursor:pointer}
.btn.primary{background:linear-gradient(135deg,#0891b2,#2563eb);border-color:transparent}
.btn.cute{background:linear-gradient(135deg,#f472b6,#f59e0b);border-color:transparent}
.btn:active{transform:translateY(1px)}
.chip{display:inline-block;padding:6px 10px;background:#0f1114;border:1px solid #2b3340;border-radius:999px;font-size:12px;margin:4px 6px 0 0;color:var(--muted)}
textarea{width:100%;min-height:240px;background:#0b0d10;color:#e5eef7;border:1px solid #2b3340;border-radius:14px;padding:12px;line-height:1.5}
.notice{font-size:12px;color:#a1a1aa}
.thumb{width:100%;max-height:260px;object-fit:cover;border-radius:12px;border:1px solid #2b3340}
.flex{display:flex;gap:8px;flex-wrap:wrap}
.divider{height:1px;background:#222831;margin:10px -14px}
.modebar{display:flex;gap:8px;flex-wrap:wrap}
.modebtn{padding:10px 12px;border-radius:999px;border:1px solid #2b3340;background:#0f1114;color:#e5eef7;cursor:pointer}
.modebtn.active{background:linear-gradient(135deg,#0891b2,#2563eb);border-color:transparent}
.modebtn.cute.active{background:linear-gradient(135deg,#f472b6,#f59e0b)}
.footer{font-size:12px;color:#8a94a3;text-align:center;margin:22px 0 10px}
</style>
</head>
<body>
<header>
  <h1>ğŸ¾ AI Animal Shorts Prompt Generator <span class="chip">Sora2 â€¢ 9:16 â€¢ 10s â€¢ v2.0</span></h1>
</header>
<main>
  <section class="card">
    <div class="modebar">
      <button id="mode-wild" class="modebtn active">ğŸ¦ é‡å¤–é©šéšªç‰ˆ (Wildlife)</button>
      <button id="mode-pet" class="modebtn cute">ğŸ§¸ å¯µç‰©ç©å…·ç‰ˆ (Pet & Toy)</button>
    </div>
    <div class="notice">é»æ“Šä¸Šæ–¹æ¨¡å¼æŒ‰éˆ•å¯ä¸€éµåˆ‡æ›æ¨¡æ¿ã€åˆ†é¡èˆ‡é¢¨æ ¼ã€‚</div>
  </section>

  <section class="card">
    <div class="row">
      <div>
        <label>Category</label>
        <select id="category"></select>

        <label>Tone & Mood</label>
        <select id="tone"></select>

        <label>Animals (comma separated)</label>
        <input id="animals" type="text" placeholder="e.g., buffalo, lions, calf / cat, golden retriever, hamster" />

        <label data-scope="wild">Location / Biome</label>
        <select id="biome"></select>
      </div>
      <div>
        <label>Scene Length</label>
        <select id="length">
          <option>10</option>
          <option>15</option>
          <option>30</option>
        </select>

        <label>Aspect Ratio</label>
        <select id="ratio">
          <option>9:16</option>
          <option>16:9</option>
        </select>

        <label>Language</label>
        <select id="lang">
          <option value="en">English</option>
          <option value="bi">English + ç¹é«”ä¸­æ–‡</option>
        </select>

        <div style="margin-top:10px" class="flex">
          <label class="chip"><input id="ambient" type="checkbox" checked /> Ambient SFX</label>
          <label class="chip"><input id="notext" type="checkbox" checked /> No on-screen text</label>
          <label class="chip"><input id="music" type="checkbox" /> Add background music</label>
        </div>

        <div class="divider"></div>

        <label>Optional: Image â†’ Auto-detect animals</label>
        <input id="img" type="file" accept="image/*" />
        <img id="thumb" class="thumb hidden" alt="preview" />
        <div class="notice">Uses TensorFlow.js MobileNet in your browser. If it fails to load, you can still type animals manually.</div>
      </div>
    </div>

    <div class="flex" style="margin-top:14px">
      <button id="gen" class="btn primary">âš¡ Generate Prompt</button>
      <button id="copy" class="btn">ğŸ“„ Copy Prompt</button>
      <button id="save" class="btn">â¬‡ï¸ Download TXT</button>
      <button id="reset" class="btn">â™»ï¸ Reset</button>
    </div>
  </section>

  <section class="card">
    <label>Output</label>
    <textarea id="out" spellcheck="false" placeholder="Generated Sora2 prompt will appear here..."></textarea>
    <div class="notice">Prompts are structured as Setting / Scene / Style / Format. Wildlife = ç´€éŒ„ç‰‡å¯«å¯¦ï¼›Pet & Toy = å¯æ„›æç¬‘ã€‚</div>
  </section>

  <section class="card">
    <div class="flex">
      <span class="chip">Mobile-first</span>
      <span class="chip">Client-side only</span>
      <span class="chip">GitHub Pages ready</span>
      <span class="chip">Two modes</span>
      <span class="chip">v2.0</span>
    </div>
  </section>

  <div class="footer">Â© 2025 Animal Prompt Kit â€” Built for Shorts creators.</div>
</main>

<script>
let tfReady=false, mobilenetModel=null;
async function ensureModel(){
  if(mobilenetModel) return mobilenetModel;
  if(!tfReady){
    await new Promise((resolve, reject)=>{
      const s=document.createElement('script');
      s.src='https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.20.0/dist/tf.min.js';
      s.onload=()=>{tfReady=true; resolve();};
      s.onerror=()=>reject(new Error('Failed to load tfjs'));
      document.head.appendChild(s);
    });
    await new Promise((resolve, reject)=>{
      const s=document.createElement('script');
      s.src='https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet@2.1.0';
      s.onload=resolve; s.onerror=()=>reject(new Error('Failed to load mobilenet'));
      document.head.appendChild(s);
    });
  }
  mobilenetModel = await mobilenet.load();
  return mobilenetModel;
}

const imgInput = document.getElementById('img');
const thumb = document.getElementById('thumb');
imgInput.addEventListener('change', async (e)=>{
  const file = e.target.files[0];
  if(!file) return;
  const url = URL.createObjectURL(file);
  thumb.src = url; thumb.classList.remove('hidden');
  try{
    const model = await ensureModel();
    const imgEl = new Image();
    imgEl.onload = async ()=>{
      const preds = await model.classify(imgEl);
      const words = preds.map(p=>p.className.split(',')[0].toLowerCase());
      const pick = [...new Set(words)].slice(0,3).join(', ');
      const animals = document.getElementById('animals');
      animals.value = animals.value ? (animals.value + ', ' + pick) : pick;
    };
    imgEl.src = url;
  }catch(err){
    console.warn(err);
    alert('Image analyzer failed to load. Please type animals manually.');
  }
});

const data = {
  wildlife: {
    tones: ["Epic","Emotional","Heroic","Tragic","Documentary"],
    biomes: ["African savanna","riverbank with muddy watering hole","dry grassland at golden hour","open plain under harsh midday sun","thornbush scrub near a shallow creek","desert dunes near rocky outcrop","rainforest edge by misty river"],
    categories: {
      "Rescue Moment": [
        "A protective {A1} charges with lowered horns to save its {A2} from {A3}. Dust and mud explode as predators scatter; the parent shields the young.",
        "{A1} mother returns and plows through {A3} to free the trapped {A2}, violent splashes at the {BIOME}.",
        "Desperate rescue: {A1} slams into the circle of {A3}, pushing them off the struggling {A2}."
      ],
      "Predator Hunt": [
        "Ambush sequence: {A3} stalk through tall grass toward {A2}; one explodes into a sprint and tackles its prey in a burst of dust.",
        "Coordinated takedown: two {A3} cut off the fleeing {A2} while another leaps from the side, jaws open."
      ],
      "Predator Ambush": [
        "Silent approach: {A3} belly-crawl through reeds, camera glides at ground level before the explosive lunge at {A2}.",
        "Shadow-and-sun play: {A3} use termite mounds for cover, then erupt toward {A2} in synchronized burst."
      ],
      "River Attack": [
        "At the water's edge, {A3} surge at {A2}; splashes and mud fill the frame as prey slips and regains footing.",
        "Crossing chaos: {A2} enters shallow channel; hidden {A3} explode from the waterline in a shock strike."
      ],
      "Herd Defense": [
        "Herd forms a horned wall of {A1}, stomping and snorting while {A3} test the line; one sudden charge scatters predators.",
        "Circle defense: adults surround the {A2} as {A3} probe for weakness."
      ],
      "Desert Pursuit": [
        "Heat shimmer chase across cracked earth; {A3} kick up dust plumes while {A2} zigzags toward a rocky ridge.",
        "Long-lens compression shows {A3} closing the gap on {A2}, sand flaring under each stride."
      ],
      "Jungle Showdown": [
        "Under dappled rainforest light, {A3} and {A1} collide in a tangle of vines and leaves.",
        "Echoing calls build tension as {A3} attempt to separate the {A2} from the group."
      ],
      "Cliff Escape": [
        "Prey scrambles up a steep escarpment; {A3} leap from ledges in risky pursuit, pebbles raining down.",
        "Narrow ledge standoff: {A2} freezes while {A3} inch closer; a misstep sends stones tumbling."
      ],
      "Crocodile Crossing": [
        "Stampede into muddy river; submerged {A3} explode upward in whitewater thrash around {A2}.",
        "Turbid water churns as jaws snap inches from the camera; survivors clamber onto the far bank."
      ]
    },
    style: (tone)=>`Ultra-realistic National Geographic documentary look, handheld tracking shots, shallow depth of field, dust/water particles, HDR high contrast, ${tone.toLowerCase()} pacing.`,
    setting: (biome)=>`${biome} under bright natural light, cinematic wildlife tone.`,
    format: (ratio,len,sfx,notext,music)=>`${ratio} vertical framing, 1080p, ${len} seconds, ${sfx}${music?', light cinematic score':''}, ${notext}.`,
    defaultAnimals: "buffalo, lions, calf"
  },
  pet: {
    tones: ["Cute","Playful","Comedic","Wholesome","Energetic"],
    biomes: ["cozy living room with soft daylight","kitchen floor with shiny tiles","backyard lawn under blue sky","kids' playroom full of plush toys","apartment hallway with sunlight"],
    categories: {
      "Toy Antics": [
        "A {P1} bats a squeaky toy while a {P2} watches; the toy zips across the floor and both sprint after it.",
        "Slow-motion pounce: {P1} leaps onto a plush {P3}, sliding comically on the wood floor."
      ],
      "Mini Adventure": [
        "Tiny road trip: a {P1} rides a toy car past obstacles made of pillows; {P2} waves a tiny flag.",
        "Exploration montage: {P1} squeezes through a cardboard tunnel, then pops out wearing a paper crown."
      ],
      "Cute Prank": [
        "{P1} sneaks behind a robot vacuum armed with a foam sword; fake dramatic duel ensues, ending in a cuddle.",
        "Peekaboo chaos: {P1} hides under a blanket fort and jumps out to surprise {P2} holding a plush."
      ],
      "Snack Quest": [
        "Snack treasure hunt: {P1} follows a trail of kibble into a toy chest, emerging with a triumphant wiggle.",
        "Close-up crunch ASMR as {P1} nibbles a treat, then tosses a rubber ball to {P2}."
      ],
      "Dance Off": [
        "Rhythm showdown: {P1} bobs head to bouncy beat while {P2} spins with a ribbon wand; confetti pop ending.",
        "Toy drum solo: {P1} pats a mini drum while {P2} shakes a plush maraca."
      ]
    },
    style: (tone)=>`Cute, colorful, high-key lighting, gentle bokeh, snappy edits, emoji-like reactions, ${tone.toLowerCase()} rhythm.`,
    setting: (biome)=>`${biome}, bright cheerful palette, cozy domestic vibe.`,
    format: (ratio,len,sfx,notext,music)=>`${ratio} vertical framing, 1080p, ${len} seconds, ${sfx}${music?', upbeat playful music':''}, ${notext}.`,
    defaultAnimals: "cat, golden retriever, hamster",
  }
};

function populateForMode(mode){
  const m = data[mode];
  const catSel = document.getElementById('category');
  const toneSel = document.getElementById('tone');
  const biomeSel = document.getElementById('biome');

  catSel.innerHTML = "";
  Object.keys(m.categories).forEach(k=>{
    const opt=document.createElement('option'); opt.value=k; opt.textContent=k; catSel.appendChild(opt);
  });

  toneSel.innerHTML="";
  m.tones.forEach(t=>{
    const opt=document.createElement('option'); opt.textContent=t; toneSel.appendChild(opt);
  });

  biomeSel.innerHTML="";
  m.biomes.forEach(b=>{
    const opt=document.createElement('option'); opt.textContent=b; biomeSel.appendChild(opt);
  });

  document.getElementById('animals').placeholder = mode==='wildlife' ? "e.g., buffalo, lions, calf" : "e.g., cat, golden retriever, hamster";
  if(!document.getElementById('animals').value){
    document.getElementById('animals').value = m.defaultAnimals;
  }
}

let currentMode = 'wildlife'; // default
populateForMode(currentMode);

const btnWild = document.getElementById('mode-wild');
const btnPet = document.getElementById('mode-pet');
btnWild.addEventListener('click', ()=>{
  currentMode='wildlife';
  btnWild.classList.add('active'); btnPet.classList.remove('active');
  populateForMode(currentMode);
});
btnPet.addEventListener('click', ()=>{
  currentMode='pet';
  btnPet.classList.add('active'); btnWild.classList.remove('active');
  populateForMode(currentMode);
});

function sample(arr){return arr[Math.floor(Math.random()*arr.length)];}

function buildPrompt(opts){
  const m = data[opts.mode];
  const len = opts.length || 10;
  const ratio = opts.ratio || "9:16";
  const biome = opts.biome;
  const tone = opts.tone;
  const lang = opts.lang || "en";
  const animals = (opts.animals||"").toLowerCase();

  const sfx = document.getElementById('ambient').checked
    ? (opts.mode==='wildlife' ? "immersive ambient sound of roaring, hooves, wind" : "cute pet sounds, purrs, barks, squeaks")
    : "natural location audio";
  const notext = document.getElementById('notext').checked ? "no text overlay" : "minimal lower-third label";
  const music = document.getElementById('music').checked;

  let scene;
  if(opts.mode==='wildlife'){
    const A1 = animals.match(/buffalo|elephant|hippo|zebra|wildebeest|rhino|giraffe/)?.[0] || "buffalo";
    const A2 = animals.match(/calf|cub|foal|fawn|gazelle|antelope|warthog/)?.[0] || "calf";
    const A3 = animals.match(/lion|lions|lioness|hyena|hyenas|wild dog|cheetah|leopard|komodo|crocodile|python|crocodiles/)?.[0] || "lions";

    const sceneT = sample(m.categories[opts.category]);
    scene = sceneT
      .replaceAll("{A1}", A1)
      .replaceAll("{A2}", A2)
      .replaceAll("{A3}", A3)
      .replaceAll("{BIOME}", biome);

  }else{
    const P1 = animals.match(/cat|kitten|puppy|dog|hamster|parrot|turtle|rabbit|bunny|golden retriever|shiba|corgi|pomeranian|poodle/)?.[0] || "cat";
    const P2 = animals.match(/dog|puppy|kitten|hamster|parrot|turtle|rabbit|bunny|cat|golden retriever|corgi/)?.[0] || "golden retriever";
    const P3 = animals.match(/lion|bear|dinosaur|shark|dragon|robot|penguin|duck/)?.[0] || "bear plush";

    const sceneT = sample(m.categories[opts.category]);
    scene = sceneT
      .replaceAll("{P1}", P1)
      .replaceAll("{P2}", P2)
      .replaceAll("{P3}", P3);
  }

  const setting = m.setting(biome);
  const style = m.style(tone);
  const format = m.format(ratio,len,sfx,notext,music);

  const promptEN = `*Setting:* ${setting}
*Scene:* ${scene}
*Style:* ${style}
*Format:* ${format}`.trim();

  if(lang === "en") return promptEN;

  const zhStyle = (opts.mode==='wildlife')
    ? `è¶…å¯«å¯¦ã€åœ‹å®¶åœ°ç†ç´€éŒ„ç‰‡è³ªæ„Ÿï¼Œæ‰‹æŒè¿½ç„¦ã€æ·ºæ™¯æ·±ã€å¡µåœŸ/æ°´èŠ±ç²’å­ã€HDR é«˜åå·®ï¼Œç¯€å¥ ${tone}.`
    : `å¯æ„›ç¹½ç´›ã€é«˜äº®åº¦ã€æŸ”ç„¦æ™¯æ·±ã€ä¿çš®å‰ªè¼¯ã€è¡¨æƒ…èª‡å¼µï¼Œç¯€å¥ ${tone}.`;

  const zhSfx = document.getElementById('ambient').checked
    ? (opts.mode==='wildlife' ? 'é‡å¤–ç’°å¢ƒéŸ³æ²ˆæµ¸' : 'å¯æ„›å¯µç‰©æ“¬è²')
    : 'ç’°å¢ƒéŸ³';

  const zhMusic = music ? (opts.mode==='wildlife' ? 'æ·¡å…¥é›»å½±é…æ¨‚' : 'æ´»æ½‘å¯æ„›é…æ¨‚') : 'ç„¡éŸ³æ¨‚åå¥½';

  const promptZH = `*å ´æ™¯è¨­å®šï¼š* ${biome}ï¼Œæ˜äº®è‡ªç„¶å…‰èˆ‡è³ªæ„Ÿã€‚
*ç•«é¢ï¼š* ${scene}
*é¢¨æ ¼ï¼š* ${zhStyle}
*è¦æ ¼ï¼š* ${ratio} ç›´å¼æ§‹åœ–ï¼Œ1080pï¼Œ${len} ç§’ï¼Œ${zhSfx}ï¼Œ${zhMusic}ï¼Œ${document.getElementById('notext').checked ? 'ç„¡å­—å¹•' : 'æœ€å°å­—å¹•' }ã€‚`;

  return promptEN + "\n\n---\n\n" + promptZH;
}

function readControls(){
  return {
    mode: currentMode,
    category: document.getElementById('category').value,
    tone: document.getElementById('tone').value,
    animals: document.getElementById('animals').value,
    biome: document.getElementById('biome').value,
    length: document.getElementById('length').value,
    ratio: document.getElementById('ratio').value,
    lang: document.getElementById('lang').value,
  };
}

document.getElementById('gen').addEventListener('click', ()=>{
  const p = buildPrompt(readControls());
  document.getElementById('out').value = p;
  document.getElementById('gen').animate([{transform:'scale(1)'},{transform:'scale(.98)'},{transform:'scale(1)'}],{duration:180});
});

document.getElementById('copy').addEventListener('click', async ()=>{
  const t = document.getElementById('out').value.trim();
  if(!t){alert('Generate a prompt first.');return;}
  await navigator.clipboard.writeText(t);
  document.getElementById('copy').textContent='âœ… Copied';
  setTimeout(()=>document.getElementById('copy').textContent='ğŸ“„ Copy Prompt',1200);
});

document.getElementById('save').addEventListener('click', ()=>{
  const blob = new Blob([document.getElementById('out').value||''], {type:'text/plain'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'animal_prompt.txt';
  a.click();
});

document.getElementById('reset').addEventListener('click', ()=>{
  document.getElementById('animals').value='';
  document.getElementById('out').value='';
  document.getElementById('length').value='10';
  document.getElementById('ratio').value='9:16';
  document.getElementById('lang').value='en';
  populateForMode(currentMode);
  document.getElementById('thumb').classList.add('hidden');
});
</script>
</body>
</html>
